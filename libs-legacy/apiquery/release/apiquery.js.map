{"version":3,"sources":["../src/apiquery.js"],"names":["AXIOS_PARAMS","ioMock","mock","Manager","io","Socket","connection","events","on","params","push","use","disconnect","recreateSocket","forEach","event","name","Apiquery","log","root","base","headers","url","wsConfig","ws","wsConnections","authToken","wsReconnect","err","response","data","showError","str","JSON","stringify","parse","config","error","message","code","path","options","substr","port","length","search","replace","array","map","a","filter","i","join","qs","indexOf","constructor","body","req","Accept","Authorization","queryParams","createUrl","method","catchError","afterFetch","parseResult","timeout","res","ctx","getCtx","_axios","axios","__cancelToken","trace","_body","params2","token","cancelToken","then","bind","Object","keys","key","socket","console","opts","tokenInCookie","query","Array","isArray","window","global","__DEV__","warn"],"mappings":"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","sourcesContent":["// import fetch from 'node-fetch';\nimport isPlainObject from 'lodash/isPlainObject';\nimport pick from 'lodash/pick';\nimport qs from 'qs';\nimport axios from 'axios';\n// import FormData from 'form-data';\nimport io from './socket.io-client';\nimport trim from './trim';\n\nconst AXIOS_PARAMS = [\n  'url',\n  'method',\n  'baseURL',\n  'transformRequest',\n  'transformResponse',\n  'headers',\n  'params',\n  'paramsSerializer',\n  'data',\n  'timeout',\n  'withCredentials',\n  'adapter',\n  'auth',\n  'responseType',\n  'responseEncoding',\n  'xsrfCookieName',\n  'xsrfHeaderName',\n  'onUploadProgress',\n  'onDownloadProgress',\n  'maxContentLength',\n  'validateStatus',\n  'maxRedirects',\n  'socketPath',\n  'httpAgent',\n  'httpsAgent',\n  'proxy',\n  '__cancelToken',\n];\n\nfunction ioMock(...initParams) {\n  // __DEV__ && console.log('ioMock', ...initParams);\n  // const socket = io(...params)\n  const mock = {\n    Manager: io.Manager,\n    Socket: io.Socket,\n    connection: null,\n    events: [],\n    on(...params) {\n      mock.events.push(['on', ...params]);\n    },\n    use(...params) {\n      mock.events.push(['use', ...params]);\n    },\n    disconnect(...params) {\n      mock.connection.disconnect(...params);\n    },\n    recreateSocket(...newInitParams) {\n      // __DEV__ && console.log('recreateSocket', ...newInitParams);\n      if (mock.connection && mock.connection.disconnect) {\n        mock.connection.disconnect();\n      }\n      mock.connection = io(...newInitParams);\n      mock.events.forEach(event => {\n        const [name, ...params] = event;\n        mock.connection[name](...params);\n      });\n\n      mock.connection.recreateSocket = (...newInitParams2) =>\n        // __DEV__ && console.log('recreateSocket2', ...newInitParams2);\n        mock.recreateSocket(...newInitParams2);\n      // __DEV__ && console.log('recreateConnection');\n      return mock.connection;\n    },\n  };\n  return mock.recreateSocket(...initParams);\n}\n\n// const DEBUG = __DEV__;\n\nexport default class Apiquery {\n  static axios = axios;\n  static qs = qs;\n  // io = io\n\n  constructor(params = {}) {\n    // console.log('ApiClient', params);\n    this.io = ioMock;\n    this.log = params.log;\n    this.root = params.root;\n    this.base = params.base;\n    this.headers = params.headers || {};\n    this.url = params.url;\n    this.wsConfig = params.ws;\n    this.wsConnections = {};\n    this.authToken = params.authToken || null;\n  }\n\n  setAuthToken(authToken) {\n    this.authToken = authToken;\n    this.wsReconnect();\n  }\n\n  // static createReq(req) {\n  //   // req.path,\n  //   // req.query,\n  //   return {\n  //     ...req,\n  //     create(params) {\n  //       const query = this.qs.stringify(params);\n  //       return (this.path || '/') + (query ? `?${query}` : '');\n  //     },\n  //     merge(params) {\n  //       return this.create({\n  //         ...this.query,\n  //         ...params,\n  //       });\n  //     },\n  //   };\n  // }\n\n  catchError(err) {\n    const { data } = err.response || {};\n    // if (true) {\n    if (this.showError && this.log) {\n      const str = `\\\n==============\n  fetch error:\n${isPlainObject(err) ? JSON.stringify(err, null, 2) : err}\n  request:\n${JSON.stringify(JSON.parse(err.config.data), null, 2)}\n  response:\n${JSON.stringify(data, null, 2)}\n==============\\\n`;\n      // console.log(str);\n      this.log.error(str);\n    }\n    if (data && data.message) {\n      // eslint-disable-next-line no-param-reassign\n      err.message = data.message;\n    }\n    if (data && data.code) {\n      // eslint-disable-next-line no-param-reassign\n      err.code = data.code;\n    }\n    // if (data.status) {\n    //   err.status = data.status;\n    // }\n    throw err;\n  }\n\n  createUrl(path, options = {}) {\n    if (path.substr(0, 5) === 'http:' || path.substr(0, 6) === 'https:') {\n      return path;\n    }\n    let url = options.url || this.url || '/';\n    const port = options.port || this.port || null;\n\n    if (url && url.length > 1 && port) {\n      if (url.search(/:(\\d+)/) !== -1) {\n        url = url.replace(/:(\\d+)/, `:${port}`);\n      } else {\n        url = `${url}:${port}`;\n      }\n    }\n\n    const base = options.base || this.base;\n    const array = [url, path[0] === '/' ? null : trim(base), trim(path)];\n    url = array\n      .map(a => trim(a))\n      .filter((a, i) => i === 0 || a)\n      .join('/');\n    if (options.qs) {\n      url += (url.indexOf('?') === -1 ? '?' : '&') + this.constructor.qs.stringify(options.qs);\n    }\n    return url;\n  }\n\n  getCtx(url, params = {}) {\n    const data = params.data || params.body;\n    const req = {\n      url,\n      headers: {\n        ...this.headers,\n      },\n      ...pick(params, AXIOS_PARAMS),\n      data,\n    };\n\n    if (!req.headers) req.headers = {};\n    if (!req.headers.Accept) req.headers.Accept = 'application/json';\n    if (!req.headers['Content-Type']) req.headers['Content-Type'] = 'application/json; charset=utf-8';\n    if (req.headers['Content-Type'] === '!') {\n      delete req.headers['Content-Type'];\n    }\n\n    // req._body = body;\n    // req.body = body;\n    // if (isPlainObject(body)) {\n    //   if (req.headers['Content-Type'] && req.headers['Content-Type'].includes('application/json')) {\n    //     req.body = JSON.stringify(body);\n    //   } else {\n    //     const form = new FormData();\n    //     Object.keys(body).forEach((key) => {\n    //       form.append(key, body[key]);\n    //     });\n    //     req.body = form;\n    //   }\n    // }\n    const authToken = params.authToken || this.authToken;\n    if (!req.headers.Authorization && authToken) {\n      req.headers.Authorization = `Bearer ${authToken}`;\n    }\n\n    req.qs = params.queryParams || params.qs;\n    if (req.qs) {\n      req.url += (req.url.indexOf('?') === -1 ? '?' : '&') + this.constructor.qs.stringify(req.qs);\n    }\n    req.url = this.createUrl(req.url);\n\n    if (!req.method) {\n      req.method = 'GET';\n    }\n    const catchError = params.catchError || this.catchError;\n    const afterFetch = params.afterFetch || this.afterFetch;\n    const parseResult = params.parseResult || this.parseResult;\n    const { timeout } = params;\n\n    return {\n      req,\n      timeout,\n      authToken,\n      catchError,\n      afterFetch,\n      parseResult,\n    };\n  }\n\n  parseResult(res) {\n    return res.data;\n  }\n\n  fetch(...args) {\n    const ctx = this.getCtx(...args);\n    const { axios: _axios } = this.constructor;\n    const { req, parseResult, catchError } = ctx;\n    const { data: { __cancelToken, ...data } = {}, ...params } = req;\n\n    if (this.log && this.log.trace) {\n      this.log.trace('[api]', req.method, req.url, req._body);\n      // this.log.trace('[api]', req.method, req.url, req._body, req);\n    }\n\n    params.data = data;\n    const params2 = {};\n    if (__cancelToken && __cancelToken.token) {\n      params.cancelToken = __cancelToken.token;\n    }\n\n    const res = _axios(params, params2)\n      .then(parseResult)\n      .catch(catchError.bind(this));\n    return res;\n  }\n\n  wsReconnect() {\n    if (this.log && this.log.trace) {\n      this.log.trace('[api] WS.wsReconnect ###', Object.keys(this.wsConnections));\n    }\n\n    Object.keys(this.wsConnections).forEach(key => {\n      const [path, options, socket] = this.wsConnections[key];\n      // __DEV__ && this.log.trace('[api] prepare reconnect @@', socket);\n      // // __DEV__ && console.log('prepare reconnect @@', socket);\n      // if (!socket.recreateSocket) {\n      //   // __DEV__ && console.log('!socket.recreateSocket', socket);\n      // }\n      socket.recreateSocket(path, options);\n      // socket.disconnect();\n      // this.ws(path, options);\n    });\n  }\n\n  ws(path = '', options = {}) {\n    // console.log('api.ws', path)\n    const key = path + JSON.stringify(options);\n    if (this.wsConnections[key]) return this.wsConnections[key];\n    if (!this.wsConfig) {\n      console.error('Вы не можете использовать api.ws без сокет конфигов'); // eslint-disable-line no-console\n      return null;\n    }\n    const opts = { ...(this.wsConfig && this.wsConfig.options), ...options };\n    // console.log('WS WS WS',\n    //   {\n    //     q: this.wsConfig && this.wsConfig.options,\n    //     w: options,\n    //     e: opts,\n    //     r: Object.assign({}, this.wsConfig && this.wsConfig.options, options)\n    //   }\n    // );\n    // console.log(opts.query, opts.query.token, this.authToken);\n    if (!(this.wsConfig && this.wsConfig.tokenInCookie)) {\n      if (opts.query && !opts.query.token && this.authToken) opts.query.token = this.authToken;\n    }\n    const params2 = {};\n    if (!this.wsConfig.tokenInCookie) {\n      if (!params2.qs) {\n        params2.qs = {\n          ...(opts.query || {}),\n        };\n      }\n      if (params2.qs && !params2.qs.token && this.authToken) params2.qs.token = this.authToken;\n    }\n\n    // console.log('WS opts.query, opts.query.token, this.authToken', opts.query, opts.query.token, this.authToken);\n    const url = this.createUrl(path, { ...this.wsConfig, ...params2 });\n    // console.log('ws url', {wsConfig: this.wsConfig, path, options, url, opts,} );\n    if (this.log && this.log.trace) {\n      this.log.trace('[api] WS', url, options);\n      // this.log.trace('[api]', req.method, req.url, req._body, req);\n    }\n    let socket = this.io(url, opts);\n\n    if (Array.isArray(socket)) {\n      if ((typeof window !== 'undefined' ? window : global).__DEV__) {\n        console.warn('multiple open sockets', socket); // eslint-disable-line no-console\n      }\n      // eslint-disable-next-line prefer-destructuring\n      socket = socket[2];\n    }\n\n    this.wsConnections[key] = [path, options, socket];\n    socket.on('disconnect', () => {\n      delete this.wsConnections[key];\n    });\n\n    return socket;\n  }\n  ws2(path = '', params = {}) {\n    if (!this.wsConfig) {\n      console.error('Вы не можете использовать api.ws без сокет конфигов'); // eslint-disable-line no-console\n      return null;\n    }\n    const params2 = { ...this.wsConfig, ...params };\n\n    if (!this.wsConfig.tokenInCookie) {\n      if (!params2.qs) params2.qs = {};\n      if (params2.qs && !params2.qs.token && this.authToken) params2.qs.token = this.authToken;\n    }\n\n    const res = this.io(this.createUrl(path, params2), {\n      ...this.wsConfig.options,\n      ...params,\n    });\n    return res;\n  }\n}\n"],"file":"apiquery.js"}